{{-- resources/views/public/doctor.blade.php --}}
<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ $title ?? 'Dr. Shabuddin Hossain Pavel ‚Äî Portfolio' }}</title>
  <meta name="description" content="{{ $metaDescription ?? 'Dr. Shabuddin Hossain Pavel is a board-certified physician specializing in internal medicine. Explore services, experience, testimonials, and book an appointment.' }}" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ["Inter", "ui-sans-serif", "system-ui"] },
          colors: {
            brand: {
              50: '#f0f9ff', 100: '#e0f2fe', 200: '#bae6fd', 300: '#7dd3fc',
              400: '#38bdf8', 500: '#0ea5e9', 600: '#0284c7', 700: '#0369a1',
              800: '#075985', 900: '#0c4a6e'
            }
          },
          boxShadow: { soft: '0 15px 30px -10px rgba(0,0,0,0.2)' }
        }
      }
    }
  </script>
</head>
<body class="bg-gradient-to-b from-brand-50 to-white text-slate-800 antialiased">

  {{-- Header --}}
  <header class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-slate-200 shadow-soft">
    <div class="max-w-7xl mx-auto px-4 md:px-8 py-3 flex items-center justify-between">
      <a href="#home" class="flex items-center gap-3">
        <div class="h-12 w-12 rounded-full bg-brand-500 text-white grid place-content-center font-bold text-lg">SHP</div>
        <div>
          <h1 class="text-lg font-bold leading-tight">Dr. Shabuddin Hossain Pavel</h1>
          <p class="text-xs text-slate-500">MBBS, FMCH ‚Äî Internal Medicine</p>
        </div>
      </a>
      <nav class="hidden md:flex gap-6 text-sm">
        <a class="hover:text-brand-600" href="#about">About</a>
        <a class="hover:text-brand-600" href="#services">Services</a>
        <a class="hover:text-brand-600" href="#experience">Experience</a>
        <a class="hover:text-brand-600" href="#testimonials">Testimonials</a>
        <a class="hover:text-brand-600" href="#contact">Contact</a>
      </nav>
      <a href="#contact" class="hidden md:inline-flex bg-gradient-to-r from-brand-500 to-brand-600 hover:from-brand-600 hover:to-brand-700 text-white text-sm font-semibold px-5 py-2.5 rounded-full shadow-soft transition">
        Book Now
      </a>
      <button id="menuBtn" class="md:hidden inline-flex items-center justify-center h-10 w-10 rounded-full border border-slate-300">‚ò∞</button>
    </div>
  </header>

  {{-- Hero --}}
  <section id="home" class="relative overflow-hidden">
    <div aria-hidden="true" class="pointer-events-none absolute inset-0 bg-gradient-to-br from-brand-50 via-white to-slate-50"></div>
    <div class="max-w-7xl mx-auto px-4 md:px-8 py-16 md:py-24 grid md:grid-cols-2 gap-10 items-center relative">
      <div>
        <span class="inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-brand-700 bg-brand-50 border border-brand-100 px-3 py-1 rounded-full">Trusted Care ‚Ä¢ 4.9‚òÖ Rating</span>
        <h2 class="text-4xl md:text-5xl font-extrabold leading-tight mt-4">
          Feel heard. Get a clear plan. <span class="text-brand-700">Start feeling better</span> today.
        </h2>
        <p class="mt-5 text-slate-600 max-w-prose">I‚Äôm Dr. Shabuddin Hossain Pavel, a board-certified internist helping adults manage diabetes, blood pressure, thyroid issues and more‚Äîwith gentle, step-by-step care tailored to you.</p>
        <div class="mt-8 flex flex-col sm:flex-row gap-3">
          <a href="#contact" class="inline-flex justify-center items-center px-6 py-3 rounded-2xl bg-brand-600 hover:bg-brand-700 text-white font-semibold shadow-soft focus:outline-none focus:ring-4 focus:ring-brand-200">Book an appointment</a>
          <a href="#services" class="inline-flex justify-center items-center px-6 py-3 rounded-2xl border border-slate-300 hover:bg-slate-50 font-semibold">See services & fees</a>
        </div>
        <div class="mt-8 grid grid-cols-2 sm:grid-cols-4 gap-3 text-center">
          <div class="p-4 rounded-xl bg-white border border-slate-200"><p class="text-2xl">‚è±Ô∏è</p><p class="text-xs text-slate-500">Average wait <strong>10 min</strong></p></div>
          <div class="p-4 rounded-xl bg-white border border-slate-200"><p class="text-2xl">üßë‚Äç‚öïÔ∏è</p><p class="text-xs text-slate-500">Female-friendly clinic</p></div>
          <div class="p-4 rounded-xl bg-white border border-slate-200"><p class="text-2xl">üåê</p><p class="text-xs text-slate-500">Bangla ‚Ä¢ English</p></div>
          <div class="p-4 rounded-xl bg-white border border-slate-200"><p class="text-2xl">üîí</p><p class="text-xs text-slate-500">Private & confidential</p></div>
        </div>
      </div>
      <div class="relative">
        <div class="relative mx-auto max-w-sm">
          <div class="aspect-[4/5] rounded-[32px] bg-[url('https://images.unsplash.com/photo-1579154204601-01588f351e85?q=80&w=1460&auto=format&fit=crop')] bg-cover bg-center shadow-soft ring-8 ring-white"></div>
          <div class="absolute -bottom-6 -left-6 hidden md:block p-4 rounded-2xl bg-white border border-slate-200 shadow-soft">
            <p class="text-sm font-semibold">Clinic Hours</p>
            <p class="text-xs text-slate-600 mt-1">Sun‚ÄìThu: 10:00‚Äì18:00</p>
            <p class="text-xs text-slate-600">Fri‚ÄìSat: Closed</p>
          </div>
          <div class="absolute -top-4 -right-4 hidden md:flex items-center gap-2 px-4 py-2 rounded-2xl bg-brand-600 text-white shadow-soft">
            <span>‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è</span><span class="text-sm font-medium">200+ reviews</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  {{-- Services (shortened for brevity; keep yours) --}}
  @includeWhen(false, 'partials.services')

  {{-- Testimonials (keep yours) --}}
  @includeWhen(false, 'partials.testimonials')

  {{-- Contact / Appointment --}}
  <section id="contact" class="py-20 bg-gradient-to-br from-brand-50 to-white border-t border-slate-200">
    <div class="max-w-6xl mx-auto px-4 md:px-8 grid lg:grid-cols-2 gap-12 items-start">

      {{-- LEFT: Forms --}}
      <div>
        <h3 class="text-3xl font-bold text-brand-700">Book Your Appointment</h3>
        <p class="mt-3 text-slate-600">Quick and simple booking ‚Äî we‚Äôll confirm within 24 hours.</p>

        {{-- Flash success --}}
        @if (session('status'))
          <div class="mt-6 rounded-2xl border border-emerald-200 bg-emerald-50 p-4 text-emerald-900">
            {{ session('status') }}
          </div>
        @endif

        {{-- Validation errors --}}
        @if ($errors->any())
          <div class="mt-6 rounded-2xl border border-rose-200 bg-rose-50 p-4 text-rose-900">
            <p class="font-semibold">Please fix the following:</p>
            <ul class="mt-2 list-disc pl-6 text-sm">
              @foreach ($errors->all() as $error)
                <li>{{ $error }}</li>
              @endforeach
            </ul>
          </div>
        @endif

        {{-- Mode switch --}}
        <div class="mt-6">
          <div class="inline-flex rounded-2xl border border-slate-200 bg-white p-1">
            <label class="flex items-center gap-2 px-4 py-2 text-sm font-medium">
              <input class="accent-brand-600" type="radio" name="mode" value="existing" checked>
              Existing Patient
            </label>
            <label class="flex items-center gap-2 px-4 py-2 text-sm font-medium">
              <input class="accent-brand-600" type="radio" name="mode" value="new">
              New Patient
            </label>
          </div>
          <p id="phone-hint" class="mt-2 text-xs text-slate-500"></p>
        </div>

        {{-- Existing patient form --}}
        <form id="form-existing" class="mt-8 grid gap-4 bg-white p-6 rounded-2xl shadow-soft border border-slate-200"
              method="POST" action="{{ route('public.appointment.existing') }}" novalidate>
          @csrf
          <h4 class="text-lg font-semibold">Existing Patient</h4>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium mb-1" for="ex_phone">Phone <span class="text-rose-600">*</span></label>
              <input id="ex_phone" name="phone" type="tel" inputmode="tel" autocomplete="tel"
                     value="{{ old('phone') }}" required
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500" placeholder="e.g. 01XXXXXXXXX">
            </div>
            <div>
              <label class="block text-sm font-medium mb-1" for="ex_dob">Date of birth</label>
              <input id="ex_dob" name="dob" type="date" value="{{ old('dob') }}"
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium mb-1" for="ex_patient_id">Patient ID</label>
              <input id="ex_patient_id" name="patient_id" type="number" inputmode="numeric" value="{{ old('patient_id') }}"
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500" placeholder="Optional">
            </div>
            <div>
              <label class="block text-sm font-medium mb-1" for="ex_doctor">Doctor <span class="text-rose-600">*</span></label>
              <select id="ex_doctor" name="doctor_id" required
                      class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
                <option value="">-- choose --</option>
                @foreach($doctors as $d)
                  <option value="{{ $d->id }}" @selected(old('doctor_id') == $d->id)>{{ $d->name }}</option>
                @endforeach
              </select>
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium mb-1" for="ex_date">Preferred date <span class="text-rose-600">*</span></label>
              <input id="ex_date" name="date" type="date" value="{{ old('date') }}" required
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
            </div>
            <div>
              <label class="block text-sm font-medium mb-1" for="ex_time">Preferred time <span class="text-rose-600">*</span></label>
              <input id="ex_time" name="start_time" type="time" value="{{ old('start_time') }}" required
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium mb-1" for="ex_notes">Notes</label>
            <textarea id="ex_notes" name="notes" rows="4"
                      class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500"
                      placeholder="Reason for visit, symptoms, etc.">{{ old('notes') }}</textarea>
          </div>

          <button type="submit"
                  class="inline-flex justify-center items-center px-5 py-3 rounded-2xl bg-brand-600 hover:bg-brand-700 text-white font-semibold shadow-soft">
            Book as Existing Patient
          </button>
          <p class="text-xs text-slate-500">Tip: Enter your phone, then either your DOB or your Patient ID to verify.</p>
        </form>

        {{-- New patient form --}}
        <form id="form-new" class="mt-8 grid gap-4 bg-white p-6 rounded-2xl shadow-soft border border-slate-200"
              method="POST" action="{{ route('public.appointment.new') }}" style="display:none" novalidate>
          @csrf
          <h4 class="text-lg font-semibold">New Patient</h4>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium mb-1" for="np_name">Full name <span class="text-rose-600">*</span></label>
              <input id="np_name" name="name" type="text" value="{{ old('name') }}" required
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500" placeholder="Your name">
            </div>
            <div>
              <label class="block text-sm font-medium mb-1" for="np_phone">Phone <span class="text-rose-600">*</span></label>
              <input id="np_phone" name="phone" type="tel" inputmode="tel" autocomplete="tel" value="{{ old('phone') }}" required
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500" placeholder="e.g. 01XXXXXXXXX">
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium mb-1" for="np_email">Email</label>
              <input id="np_email" name="email" type="email" value="{{ old('email') }}"
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500" placeholder="you@example.com">
            </div>
            <div>
              <label class="block text-sm font-medium mb-1" for="np_dob">Date of birth</label>
              <input id="np_dob" name="dob" type="date" value="{{ old('dob') }}"
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium mb-1" for="np_gender">Gender</label>
              <select id="np_gender" name="gender"
                      class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
                <option value="">-- choose --</option>
                <option value="male" @selected(old('gender')=='male')>Male</option>
                <option value="female" @selected(old('gender')=='female')>Female</option>
                <option value="other" @selected(old('gender')=='other')>Other</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium mb-1" for="np_doctor">Doctor <span class="text-rose-600">*</span></label>
              <select id="np_doctor" name="doctor_id" required
                      class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
                <option value="">-- choose --</option>
                @foreach($doctors as $d)
                  <option value="{{ $d->id }}" @selected(old('doctor_id')==$d->id)>{{ $d->name }}</option>
                @endforeach
              </select>
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium mb-1" for="np_date">Preferred date <span class="text-rose-600">*</span></label>
              <input id="np_date" name="date" type="date" value="{{ old('date') }}" required
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
            </div>
            <div>
              <label class="block text-sm font-medium mb-1" for="np_time">Preferred time <span class="text-rose-600">*</span></label>
              <input id="np_time" name="start_time" type="time" value="{{ old('start_time') }}" required
                     class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500">
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium mb-1" for="np_notes">Notes</label>
            <textarea id="np_notes" name="notes" rows="4"
                      class="w-full rounded-xl border-slate-300 focus:border-brand-500 focus:ring-brand-500"
                      placeholder="Reason for visit, symptoms, etc.">{{ old('notes') }}</textarea>
          </div>

          <button type="submit"
                  class="inline-flex justify-center items-center px-5 py-3 rounded-2xl bg-brand-600 hover:bg-brand-700 text-white font-semibold shadow-soft">
            Book as New Patient
          </button>
        </form>

        <p class="mt-3 text-xs text-slate-500">Emergency? Call 999 or visit the nearest emergency department.</p>
      </div>

      {{-- RIGHT: Location --}}
      <div class="bg-white p-6 rounded-2xl shadow-soft border border-slate-200 space-y-4">
        <h4 class="font-semibold text-lg text-brand-700">Visit Us</h4>
        <p class="text-sm text-slate-600">12 Lakeview Rd, Gulshan, Dhaka 1212</p>
        <iframe class="w-full h-60 rounded-xl border" style="border:0" loading="lazy" allowfullscreen referrerpolicy="no-referrer-when-downgrade" src="https://maps.google.com/maps?q=Dhaka%20Gulshan&t=&z=13&ie=UTF8&iwloc=&output=embed"></iframe>
        <div class="flex gap-3">
          <a href="tel:+8801000000000" class="inline-flex items-center gap-2 px-4 py-2 rounded-xl border border-slate-300 hover:bg-slate-50">üìû Call</a>
          <a href="mailto:clinic@example.com" class="inline-flex items-center gap-2 px-4 py-2 rounded-xl border border-slate-300 hover:bg-slate-50">‚úâÔ∏è Email</a>
        </div>
      </div>
    </div>
  </section>

  {{-- FAQs (keep yours) --}}

  <footer class="py-8 bg-brand-700 text-center text-white">
    <p>¬© <span id="year"></span> Dr. Shabuddin Hossain Pavel. All rights reserved.</p>
  </footer>

  {{-- Scripts --}}
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // Toggle forms
    document.querySelectorAll('input[name="mode"]').forEach(r => {
      r.addEventListener('change', () => {
        const isExisting = document.querySelector('input[name="mode"]:checked').value === 'existing';
        document.getElementById('form-existing').style.display = isExisting ? '' : 'none';
        document.getElementById('form-new').style.display      = isExisting ? 'none' : '';
      });
    });

    // Optional: live phone check for existing patients
    const exPhone = document.getElementById('ex_phone');
    const exDob   = document.getElementById('ex_dob');
    const exPid   = document.getElementById('ex_patient_id');
    const hint    = document.getElementById('phone-hint');
    let t;

    function checkPatient() {
      clearTimeout(t);
      const phone = exPhone?.value.trim();
      const dob   = exDob?.value;
      const pid   = exPid?.value;
      if (!phone || phone.length < 6) { if(hint) hint.textContent=''; return; }

      t = setTimeout(async () => {
        try {
          const u = new URL(@json(route('public.patients.check')), window.location.origin);
          u.searchParams.set('phone', phone);
          if (dob) u.searchParams.set('dob', dob);
          if (pid) u.searchParams.set('patient_id', pid);

          const r = await fetch(u, {credentials: 'same-origin'});
          if (!r.ok) return;
          const data = await r.json();
          if (hint) hint.textContent = data.exists ? `‚úÖ Found: ${data.patient?.name ?? 'match'}` : '‚ö†Ô∏è No matching patient found.';
        } catch {}
      }, 400);
    }
    exPhone?.addEventListener('input', checkPatient);
    exDob?.addEventListener('change', checkPatient);
    exPid?.addEventListener('input', checkPatient);
  </script>

  {{-- Sticky mobile actions --}}
  <div class="fixed bottom-4 inset-x-4 z-50 md:hidden">
    <div class="flex gap-3 bg-white/90 backdrop-blur border border-slate-200 rounded-2xl p-2 shadow-soft">
      <a href="tel:+8801000000000" class="flex-1 inline-flex justify-center items-center px-4 py-3 rounded-xl border border-slate-300 font-semibold">Call</a>
      <a href="#contact" class="flex-1 inline-flex justify-center items-center px-4 py-3 rounded-xl bg-brand-600 text-white font-semibold">Book</a>
    </div>
  </div>

  {{-- WhatsApp --}}
  <a href="https://wa.me/8801000000000" class="fixed hidden md:flex right-5 bottom-5 h-12 w-12 rounded-full bg-emerald-500 text-white items-center justify-center shadow-soft" aria-label="Chat on WhatsApp">üí¨</a>
</body>
</html>
